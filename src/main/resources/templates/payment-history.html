<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <title>Payment History - HotelGroup</title>
</head>
<body>

<div layout:fragment="content" class="bg-light py-5">
    <div class="container" style="max-width: 900px;">

        <div class="d-flex justify-content-between align-items-center mb-5">
            <div>
                <h1 class="font-serif fw-bold h2 m-0 text-dark">Payment History</h1>
                <p class="text-secondary small mb-0">Track all your transactions</p>
            </div>
            <span class="badge bg-white text-secondary border border-light-subtle fw-normal rounded-1 px-3 py-2">
                Client ID: <span th:text="${session.USER_ID}">#</span>
            </span>
        </div>

        <div class="row g-4">

            <div class="col-md-3">
                <div class="bg-white p-3 shadow-sm border border-light-subtle rounded-1 h-100">
                    <div class="d-flex flex-column gap-2 sticky-top" style="top: 100px;">
                        <a href="/profile" class="btn btn-outline-luxury w-100 text-start border-0 text-secondary hover-dark">Personal Info</a>
                        <a href="/my-bookings" class="btn btn-outline-luxury w-100 text-start border-0 text-secondary hover-dark">My Bookings</a>

                        <a href="/payments/history" class="btn btn-luxury w-100 text-start d-flex justify-content-between align-items-center">
                            <span>Payment History</span>
                            <span>&rsaquo;</span>
                        </a>
                        <a href="/promotions" class="btn btn-outline-luxury w-100 text-start border-0 text-secondary hover-dark">
                            Promotions
                        </a>
                        <a href="/reviews" class="btn btn-outline-luxury w-100 text-start border-0 text-secondary hover-dark">
                            My Reviews
                        </a>
                        <a href="/favorites" class="btn btn-outline-luxury w-100 text-start border-0 text-secondary hover-dark">
                            Favorites
                        </a>
                    </div>
                </div>
            </div>

            <div class="col-md-9">
                <div class="bg-white p-5 shadow-sm border-top border-4 border-dark rounded-1" style="min-height: 400px;">

                    <div th:if="${payments == null or payments.isEmpty()}" class="h-100 d-flex flex-column justify-content-center align-items-center text-center py-5">
                        <div class="mb-4 text-secondary opacity-50">
                            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg>
                        </div>
                        <h3 class="font-serif fw-bold h4 mb-2 text-dark">No Payments Yet</h3>
                        <p class="text-secondary mb-4 small" style="max-width: 300px;">
                            You haven't made any payments yet. Once you book a room, transactions will appear here.
                        </p>
                        <a href="/my-bookings" class="btn btn-luxury px-5 py-2">View Bookings</a>
                    </div>

                    <div th:if="${payments != null and !payments.isEmpty()}">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle">
                                <thead class="table-light small text-uppercase text-secondary">
                                <tr>
                                    <th scope="col" class="py-3 ps-3 border-0">Date</th>
                                    <th scope="col" class="py-3 border-0">Description</th>
                                    <th scope="col" class="py-3 border-0">Method</th>
                                    <th scope="col" class="py-3 border-0 text-end pe-3">Amount</th>
                                    <th scope="col" class="py-3 border-0 text-center">Status</th>
                                </tr>
                                </thead>
                                <tbody class="border-top-0">
                                <tr th:each="payment : ${payments}">
                                    <td class="ps-3 text-secondary small" th:text="${payment.payment_date}">2023-01-01</td>
                                    <td>
                                        <span class="d-block fw-bold text-dark x-small" th:text="${payment.hotel_name}">Hotel Name</span>
                                        <span class="d-block text-secondary x-small">Room #<span th:text="${payment.room_number}">101</span></span>
                                    </td>
                                    <td class="text-secondary small text-uppercase" th:text="${payment.method}">CARD</td>
                                    <td class="text-end pe-3 fw-bold text-dark" th:text="${payment.amount} + ' ₴'">5000 ₴</td>
                                    <td class="text-center">
                                            <span class="badge rounded-pill fw-normal x-small px-2"
                                                  th:classappend="${payment.status == 'completed' ? 'bg-success-subtle text-success' : 'bg-warning-subtle text-warning'}"
                                                  th:text="${payment.status}">
                                                COMPLETED
                                            </span>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .x-small { font-size: 0.75rem; }
    .bg-success-subtle { background-color: #dcfce7 !important; color: #166534 !important; } /* Green-100 / Green-800 */
    .bg-warning-subtle { background-color: #fef9c3 !important; color: #854d0e !important; } /* Yellow-100 / Yellow-800 */
    .hover-dark:hover { color: #111827 !important; background-color: #f3f4f6; }
</style>

</body>
</html>